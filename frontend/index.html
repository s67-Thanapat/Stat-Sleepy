<!-- =========================
File: /index.html (‡∏´‡∏ô‡πâ‡∏≤ Main)
========================= -->
<!doctype html>
<html lang="th" translate="no">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>SleepStats ‚Ä¢ ‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å</title>
  <link rel="stylesheet" href="./css/styles.css" />
  <script defer src="./js/main.js"></script>

  <style>
    /* TOP BAR */
    .topbar{background:linear-gradient(90deg,#0b5bd3,#23a6ff);color:#fff;font-size:14px;padding:6px 0}
    .topbar .wrap{max-width:1080px;margin:0 auto;padding:0 16px;display:flex;align-items:center;gap:12px;justify-content:space-between}
    .tb-left,.tb-right{display:flex;align-items:center;gap:12px;flex-wrap:wrap}
    .tb-link{color:#fff;text-decoration:none;display:inline-flex;align-items:center;gap:6px;padding:6px 10px;border-radius:10px}
    .tb-link:hover{background:rgba(255,255,255,.12)}
    .tb-search{display:flex;align-items:center;gap:0;background:#fff;border-radius:10px;overflow:hidden;box-shadow:0 2px 10px rgba(0,0,0,.15)}
    .tb-search input{border:0;outline:0;padding:8px 12px;min-width:240px;font-size:14px}
    .tb-search button{border:0;background:#0b5bd3;color:#fff;padding:8px 12px;cursor:pointer}

    /* NAVBAR */
    .nav-main{background:#fff;color:#0b0c10;border-bottom:1px solid rgba(0,0,0,.08);position:sticky;top:0;z-index:50}
    .nav-inner2{max-width:1080px;margin:0 auto;padding:10px 16px;display:flex;align-items:center;gap:16px}
    .brand{font-weight:800;letter-spacing:.2px;color:inherit;text-decoration:none;display:flex;align-items:center;gap:10px}
    .brand img{height:42px;width:auto;display:block}
    .menu2{display:flex;align-items:center;gap:16px;margin-left:auto;flex-wrap:wrap}
    .menu2 a{color:inherit;text-decoration:none;padding:8px 10px;border-radius:12px;border:1px solid transparent}
    .menu2 a:hover{background:rgba(0,0,0,.04)}

    .btn{border:1px solid rgba(0,0,0,.1);background:#f6f7f9;padding:8px 12px;border-radius:12px;text-decoration:none}
    .btn-primary{background:#2563eb;color:#fff;border-color:transparent}
    .btn-primary:hover{filter:brightness(.95)}

    /* auth status */
    #authUser{display:flex;align-items:center;gap:8px;color:#374151;font-weight:600}
    .avatar{width:26px;height:26px;display:inline-grid;place-items:center;border-radius:50%;background:#2563eb;color:#fff;font-weight:700}

    /* mobile */
    .hamburger{display:none;margin-left:auto;font-size:20px;background:none;border:none;padding:8px 10px;border-radius:10px}
    @media (max-width:820px){
      .tb-search input{min-width:140px}
      .hamburger{display:block}
      .menu2{display:none;width:100%;flex-direction:column;align-items:flex-start;padding-top:8px}
      .menu2.open{display:flex}
    }
  </style>
</head>
<body>
  <!-- TOP BAR -->
  <div class="topbar">
    <div class="wrap">
      <div class="tb-left">
        <a class="tb-link" href="#">üìò Facebook</a>
        <a class="tb-link" href="#">üì∏ Instagram</a>
        <form class="tb-search" onsubmit="event.preventDefault(); alert('‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤: '+(this.q.value||''));">
          <input name="q" type="search" placeholder="Please Enter Your Search Keyword..." />
          <button type="submit">üîç</button>
        </form>
      </div>
      <div class="tb-right">
        <a class="tb-link" href="#">üìç Google Maps</a>
        <a class="tb-link" href="tel:025552000">üìû 0-2555-2000</a>
        <a class="tb-link" href="mailto:hello@sleepstats.app">‚úâÔ∏è hello@sleepstats.app</a>
      </div>
    </div>
  </div>

  <!-- MAIN NAVBAR -->
  <header class="nav-main">
    <div class="nav-inner2">
      <a class="brand" href="./sleepstat.html">
        <img src="./assets/logo.png" alt="SleepStats Logo" onerror="this.style.display='none'">
        <span>SleepStats</span>
      </a>

      <button class="hamburger" id="hamburger" aria-label="Toggle menu" aria-expanded="false">‚ò∞</button>

      <nav class="menu2" id="menu">
        <a href="./pages/graph-age-sleep.html">‡∏≠‡∏≤‡∏¢‡∏∏ √ó ‡∏Å‡∏≤‡∏£‡∏ô‡∏≠‡∏ô (Histogram)</a>
        <a href="./pages/graph-quality-trend.html">‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏°‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏Å‡∏≤‡∏£‡∏ô‡∏≠‡∏ô</a>
        <a href="./pages/graph-time-distribution.html">‡∏Å‡∏£‡∏∞‡∏à‡∏≤‡∏¢‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏ô‡∏≠‡∏ô</a>
        <a href="./pages/survey.html">‡∏Å‡∏£‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏°</a>

        <!-- auth area -->
        <span id="authUser"></span>
        <a id="btnLogin"  class="btn btn-primary" href="./pages/signin.html?next=/admin.html">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</a>
        <a id="btnLogout" class="btn" style="display:none" href="javascript:void(0)">‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</a>
      </nav>
    </div>
  </header>

  <!-- MAIN -->
  <main class="container">
    <section class="hero">
      <h1>‡∏™‡∏£‡∏∏‡∏õ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏Å‡∏≤‡∏£‡∏ô‡∏≠‡∏ô</h1>
      <p class="muted">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡∏ô‡∏¥‡∏î‡∏Å‡∏£‡∏≤‡∏ü‡∏à‡∏≤‡∏Å‡πÅ‡∏ñ‡∏ö‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏ä‡∏¥‡∏á‡∏•‡∏∂‡∏Å ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡πà‡∏≤‡∏ô‡πÅ‡∏ö‡∏ö‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏°</p>
      <div class="quick-actions">
        <a class="chip" href="./pages/graph-age-sleep.html">‡∏î‡∏π‡∏Å‡∏£‡∏≤‡∏ü ‡∏≠‡∏≤‡∏¢‡∏∏ √ó ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á‡∏ô‡∏≠‡∏ô</a>
        <a class="chip" href="./pages/graph-quality-trend.html">‡∏î‡∏π‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏°‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û</a>
        <a class="chip" href="./pages/graph-time-distribution.html">‡∏î‡∏π‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡∏à‡∏≤‡∏¢‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤</a>
        <a class="chip" href="./pages/survey.html">‡∏Å‡∏£‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏°</a>
      </div>
    </section>

    <section class="cards">
      <article class="card">
        <h2>‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏¢‡∏±‡∏á‡πÑ‡∏á‡∏î‡∏µ?</h2>
        <p>‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏ô‡∏≠‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì ‡∏´‡∏£‡∏∑‡∏≠‡∏Å‡∏£‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏°‡∏™‡∏±‡πâ‡∏ô ‡πÜ ‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡∏î‡∏π‡∏Å‡∏£‡∏≤‡∏ü‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡πÑ‡∏î‡πâ‡∏ó‡∏∏‡∏Å‡πÄ‡∏°‡∏∑‡πà‡∏≠</p>
        <a class="btn btn-primary" href="./pages/survey.html">‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏ö‡∏ö‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏°</a>
      </article>
      <article class="card">
        <h2>‡∏™‡∏≥‡∏£‡∏ß‡∏à‡∏Å‡∏£‡∏≤‡∏ü</h2>
        <p>‡πÄ‡∏à‡∏≤‡∏∞‡∏•‡∏∂‡∏Å‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå‡∏Ç‡∏≠‡∏á‡∏≠‡∏≤‡∏¢‡∏∏‡πÅ‡∏•‡∏∞‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á‡∏Å‡∏≤‡∏£‡∏ô‡∏≠‡∏ô ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏Å‡∏≤‡∏£‡∏ô‡∏≠‡∏ô ‡πÅ‡∏•‡∏∞‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏ä‡∏≠‡∏ö‡∏ô‡∏≠‡∏ô</p>
        <a class="btn" href="./sleepstat.html">‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡∏Å‡∏£‡∏≤‡∏ü</a>
      </article>
    </section>
  </main>

  <footer class="container footer">
    <span class="muted">¬© 2025 SleepStats</span>
  </footer>

  <!-- Supabase & Auth Status -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script>
    const SUPABASE_URL = "https://nbxuzdrutlvavirpzpjt.supabase.co";
    const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im5ieHV6ZHJ1dGx2YXZpcnB6cGp0Iiwicm9zZSI6ImFub24iLCJpYXQiOjE3NTgzODUzMDYsImV4cCI6MjA3Mzk2MTMwNn0.tD4noFRKDFcA9x-A5udQSjkhKuXbccPdohdFjd8Fyo4";
    const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

    const authUser = document.getElementById('authUser');
    const btnLogin  = document.getElementById('btnLogin');
    const btnLogout = document.getElementById('btnLogout');

    function avatar(email){
      const ch = (email||'?').trim()[0]?.toUpperCase() || '?';
      return `<span class="avatar">${ch}</span>`;
    }

    async function renderAuth(){
      const { data: { session } } = await supabase.auth.getSession();
      console.log("Session check @", location.origin, "=>", session?.user?.email); // debug
      if (session?.user) {
        const email = session.user.email;
        authUser.innerHTML = `${avatar(email)}<span>${email}</span>`;
        btnLogin.style.display = 'none';
        btnLogout.style.display = 'inline-block';
      } else {
        authUser.innerHTML = '';
        btnLogin.style.display = 'inline-block';
        btnLogout.style.display = 'none';
      }
    }
    renderAuth();
    supabase.auth.onAuthStateChange(renderAuth);

    btnLogout?.addEventListener('click', async ()=>{
      await supabase.auth.signOut();
      location.href = '/index.html';
    });

    (function () {
      const btn = document.getElementById('hamburger');
      const menu = document.getElementById('menu');
      if (!btn || !menu) return;
      btn.addEventListener('click', () => {
        const open = menu.classList.toggle('open');
        btn.setAttribute('aria-expanded', open ? 'true' : 'false');
      });
    })();
  </script>
</body>
</html>
